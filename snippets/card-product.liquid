{% comment %}
  Minimal product card for Lucent collection grid.
{% endcomment %}

{%- unless skip_styles -%}
  {{ 'component-price.css' | asset_url | stylesheet_tag }}
{%- endunless -%}

{%- if card_product and card_product != empty -%}
  {%- liquid
    assign ratio = 1
    if card_product.featured_media and media_aspect_ratio == 'portrait'
      assign ratio = 0.8
    elsif card_product.featured_media and media_aspect_ratio == 'adapt'
      assign ratio = card_product.featured_media.aspect_ratio
    endif
    if ratio == 0 or ratio == null
      assign ratio = 1
    endif
  -%}

  <div class="lucent-card">
    <a class="lucent-card__media-link" href="{{ card_product.url }}" aria-label="{{ card_product.title | escape }}">
      {%- if card_product.featured_media -%}
        <div class="lucent-card__media" style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;">
          <div class="media media--transparent">
            {% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
            <img
              srcset="
                {%- if card_product.featured_media.width >= 360 -%}{{ card_product.featured_media | image_url: width: 360 }} 360w,{%- endif -%}
                {%- if card_product.featured_media.width >= 533 -%}{{ card_product.featured_media | image_url: width: 533 }} 533w,{%- endif -%}
                {%- if card_product.featured_media.width >= 720 -%}{{ card_product.featured_media | image_url: width: 720 }} 720w,{%- endif -%}
                {%- if card_product.featured_media.width >= 940 -%}{{ card_product.featured_media | image_url: width: 940 }} 940w,{%- endif -%}
                {{ card_product.featured_media | image_url }} {{ card_product.featured_media.width }}w
              "
              src="{{ card_product.featured_media | image_url: width: 720 }}"
              sizes="(min-width: {{ settings.page_width }}px) 420px, (min-width: 990px) 33vw, 50vw"
              alt="{{ card_product.featured_media.alt | escape }}"
              class="motion-reduce"
              {% unless lazy_load == false %}loading="lazy"{% endunless %}
              width="{{ card_product.featured_media.width }}"
              height="{{ card_product.featured_media.height }}"
            >
            {% comment %}theme-check-enable ImgLazyLoading{% endcomment %}
          </div>
        </div>
      {%- endif -%}
    </a>

    <div class="lucent-card__meta">
      <p class="lucent-card__title">
        <a href="{{ card_product.url }}" class="full-unstyled-link">
          {{ card_product.title | escape }}
        </a>
      </p>

      <div class="lucent-card__price">
        {% render 'price', product: card_product, price_class: '', show_compare_at_price: false %}
      </div>
    </div>
  </div>

  {%- style -%}
    /* Minimal card styling scoped by class only */
    .lucent-card__media {
      position: relative;
    }
    .lucent-card__media::before {
      content: "";
      display: block;
      padding-bottom: var(--ratio-percent);
    }
    .lucent-card__media .media {
      position: absolute;
      inset: 0;
    }
    .lucent-card__meta {
      margin-top: 1.0rem;
      font-size: 1.2rem;
      line-height: 1.6;
    }
    .lucent-card__title {
      margin: 0;
      font-weight: 400;
      opacity: 0.95;
    }
    .lucent-card__price {
      margin-top: 0.1rem;
      opacity: 0.85;
    }
    .lucent-card__price .price {
      font-size: 1.2rem;
    }
    .lucent-card__price .price__container {
      justify-content: flex-start;
    }
  {%- endstyle -%}

{%- else -%}
  <div class="lucent-card">
    <div class="lucent-card__meta">
      <p class="lucent-card__title">{{ 'onboarding.product_title' | t }}</p>
    </div>
  </div>
{%- endif -%}
